{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\834043\\\\Desktop\\\\study\\\\Personal_Web_Site\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\834043\\\\Desktop\\\\study\\\\Personal_Web_Site\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\834043\\\\Desktop\\\\study\\\\Personal_Web_Site\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Button,Form,Spinner,Alert}from'react-bootstrap';import{useHistory,Link}from\"react-router-dom\";import{useDispatch,useSelector}from\"react-redux\";import{Redirect}from'react-router-dom';import{login}from\"../Actions/auth\";import{l_wrongPassword,l_wrongUser}from'./message';import{WRONG_PASSWORD,USER_NOT_FOUND,LOGIN_SUCCESS}from'./type';import'../css/Login.css';function LoginPage(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),alert=_useState4[0],setAlert=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),alertMessage=_useState6[0],setAlertMessage=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useSelector=useSelector(function(state){return state.auth;}),isLoggedIn=_useSelector.isLoggedIn;var _useSelector2=useSelector(function(state){return state.message;}),message=_useSelector2.message;var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),validated=_useState10[0],setValidated=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),userID=_useState12[0],setUserID=_useState12[1];var dispatch=useDispatch();// let _uploadResult;\n// let history = useHistory();\nvar handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var form;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();console.log(isLoggedIn);setLoading(true);form=e.currentTarget;if(form.checkValidity()===false){setLoading(false);e.preventDefault();e.stopPropagation();setValidated(true);}else{// const userID = e.target.login_userID.value;\n// const password = password;\ndispatch(login(userID,password)).catch(function(){setLoading(false);});}if(message==WRONG_PASSWORD){setLoading(false);setPassword('');setUserID('');}else if(message==USER_NOT_FOUND){setUserID('');setPassword('');}case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(message==LOGIN_SUCCESS){props.history.push(\"/home\");window.location.reload();}else if(message==WRONG_PASSWORD){setLoading(false);setAlert(true);setAlertMessage({body:l_wrongPassword,forgot:/*#__PURE__*/React.createElement(Link,{to:\"/forgot/password\"},\"Forgot ID or Password?\")});setPassword('');setUserID('');}else if(message==USER_NOT_FOUND){setLoading(false);setAlert(true);setAlertMessage({body:l_wrongUser,forgot:/*#__PURE__*/React.createElement(Link,{to:\"/forgot/id\"},\"Forgot ID or Password?\")});setPassword('');setUserID('');}},[message]);if(isLoggedIn){return/*#__PURE__*/React.createElement(Redirect,{to:\"/home\"});}var onChangePassword=function onChangePassword(e){var _password=e.target.value;setPassword(_password);};var onChangeUserID=function onChangeUserID(e){var _userID=e.target.value;setUserID(_userID);};return/*#__PURE__*/React.createElement(\"div\",{className:\"login_whole\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"LoginPage_login\"},\"Login\"),/*#__PURE__*/React.createElement(Form,{noValidate:true,validated:validated,onSubmit:handleSubmit},/*#__PURE__*/React.createElement(Form.Group,null,/*#__PURE__*/React.createElement(Form.Label,null,\"User ID\"),/*#__PURE__*/React.createElement(Form.Control,{name:\"login_userID\",type:\"text\",placeholder:\"Enter User ID\",value:userID,onChange:onChangeUserID,required:true})),/*#__PURE__*/React.createElement(Form.Group,null,/*#__PURE__*/React.createElement(Form.Label,null,\"Password\"),/*#__PURE__*/React.createElement(Form.Control,{name:\"login_password\",type:\"password\",placeholder:\"Password\",value:password,onChange:onChangePassword,required:true})),alert&&/*#__PURE__*/React.createElement(Alert,{variant:\"danger\",onClose:function onClose(){return setAlert(false);},dismissible:true},/*#__PURE__*/React.createElement(\"p\",null,alertMessage.body),/*#__PURE__*/React.createElement(\"p\",null,alertMessage.forgot)),loading?/*#__PURE__*/React.createElement(Button,{variant:\"primary\",type:\"submit\"},/*#__PURE__*/React.createElement(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":\"true\"})):/*#__PURE__*/React.createElement(Button,{variant:\"primary\",type:\"submit\"},\"Login\"),/*#__PURE__*/React.createElement(\"p\",null,\"Do you need a new account? \",/*#__PURE__*/React.createElement(\"a\",{href:\"/registration\"},\"Register\"),\" here\")));}export default LoginPage;","map":{"version":3,"sources":["C:/Users/834043/Desktop/study/Personal_Web_Site/client/src/Components/LoginPage.jsx"],"names":["React","useState","useEffect","Button","Form","Spinner","Alert","useHistory","Link","useDispatch","useSelector","Redirect","login","l_wrongPassword","l_wrongUser","WRONG_PASSWORD","USER_NOT_FOUND","LOGIN_SUCCESS","LoginPage","props","loading","setLoading","alert","setAlert","alertMessage","setAlertMessage","password","setPassword","state","auth","isLoggedIn","message","validated","setValidated","userID","setUserID","dispatch","handleSubmit","e","preventDefault","console","log","form","currentTarget","checkValidity","stopPropagation","catch","history","push","window","location","reload","body","forgot","onChangePassword","_password","target","value","onChangeUserID","_userID"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Button, Form, Spinner, Alert } from 'react-bootstrap';\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Redirect } from 'react-router-dom';\r\nimport { login } from \"../Actions/auth\";\r\nimport { l_wrongPassword, l_wrongUser } from './message';\r\nimport { WRONG_PASSWORD, USER_NOT_FOUND, LOGIN_SUCCESS } from './type';\r\nimport '../css/Login.css';\r\n\r\nfunction LoginPage(props) {\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [alert, setAlert] = useState(false);\r\n\tconst [alertMessage, setAlertMessage] = useState(null);\r\n\tconst [password, setPassword] = useState(null);\r\n\tconst { isLoggedIn } = useSelector(state => state.auth);\r\n\tconst { message } = useSelector(state => state.message);\r\n\tconst [validated, setValidated] = useState(false);\r\n\tconst [userID, setUserID] = useState(null);\r\n\r\n\r\n\tconst dispatch = useDispatch();\r\n\r\n\t// let _uploadResult;\r\n\t// let history = useHistory();\r\n\r\n\tconst handleSubmit = async (e) => {\r\n\t\te.preventDefault();\r\n\t\tconsole.log(isLoggedIn)\r\n\t\tsetLoading(true);\r\n\r\n\t\tconst form = e.currentTarget;\r\n\t\tif (form.checkValidity() === false) {\r\n\t\t\tsetLoading(false);\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\tsetValidated(true);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// const userID = e.target.login_userID.value;\r\n\t\t\t// const password = password;\r\n\t\t\tdispatch(login(userID, password))\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (message == WRONG_PASSWORD) {\r\n\t\t\tsetLoading(false);\r\n\t\t\tsetPassword('');\r\n\t\t\tsetUserID('');\r\n\t\t} else if (message == USER_NOT_FOUND) {\r\n\t\t\tsetUserID('');\r\n\t\t\tsetPassword('');\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (message == LOGIN_SUCCESS) {\r\n\t\t\tprops.history.push(\"/home\");\r\n\t\t\twindow.location.reload();\r\n\t\t}\r\n\t\telse if (message == WRONG_PASSWORD) {\r\n\t\t\tsetLoading(false);\r\n\t\t\tsetAlert(true);\r\n\t\t\tsetAlertMessage({\r\n\t\t\t\tbody: l_wrongPassword,\r\n\t\t\t\tforgot: <Link to='/forgot/password'>Forgot ID or Password?</Link>\r\n\t\t\t})\r\n\t\t\tsetPassword('');\r\n\t\t\tsetUserID('');\r\n\t\t}\r\n\t\telse if (message == USER_NOT_FOUND) {\r\n\t\t\tsetLoading(false);\r\n\t\t\tsetAlert(true);\r\n\t\t\tsetAlertMessage({\r\n\t\t\t\tbody: l_wrongUser,\r\n\t\t\t\tforgot: <Link to='/forgot/id'>Forgot ID or Password?</Link>\r\n\t\t\t})\r\n\t\t\tsetPassword('');\r\n\t\t\tsetUserID('');\r\n\t\t}\r\n\t}, [message])\r\n\tif (isLoggedIn) {\r\n\t\treturn <Redirect to=\"/home\" />;\r\n\t}\r\n\r\n\tconst onChangePassword = (e) => {\r\n\t\tconst _password = e.target.value;\r\n\t\tsetPassword(_password);\r\n\t};\r\n\r\n\tconst onChangeUserID = (e) => {\r\n\t\tconst _userID = e.target.value;\r\n\t\tsetUserID(_userID);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"login_whole\">\r\n\t\t\t<h1 className=\"LoginPage_login\">Login</h1>\r\n\t\t\t<Form noValidate validated={validated} onSubmit={handleSubmit}>\r\n\t\t\t\t<Form.Group >\r\n\t\t\t\t\t<Form.Label>User ID</Form.Label>\r\n\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\tname=\"login_userID\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder=\"Enter User ID\"\r\n\t\t\t\t\t\tvalue={userID}\r\n\t\t\t\t\t\tonChange={onChangeUserID}\r\n\t\t\t\t\t\trequired />\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group>\r\n\t\t\t\t\t<Form.Label>Password</Form.Label>\r\n\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\tname=\"login_password\"\r\n\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\tplaceholder=\"Password\"\r\n\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\tonChange={onChangePassword}\r\n\t\t\t\t\t\trequired />\r\n\t\t\t\t</Form.Group>\r\n\t\t\t\t{alert &&\r\n\t\t\t\t\t<Alert variant=\"danger\" onClose={() => setAlert(false)} dismissible>\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t{alertMessage.body}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t{alertMessage.forgot}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Alert>\r\n\t\t\t\t}\r\n\t\t\t\t{loading ?\r\n\t\t\t\t\t<Button variant=\"primary\" type=\"submit\">\r\n\t\t\t\t\t\t<Spinner\r\n\t\t\t\t\t\t\tas=\"span\"\r\n\t\t\t\t\t\t\tanimation=\"border\"\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\trole=\"status\"\r\n\t\t\t\t\t\t\taria-hidden=\"true\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t: <Button variant=\"primary\" type=\"submit\">\r\n\t\t\t\t\t\tLogin\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t}\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tDo you need a new account? <a href=\"/registration\">Register</a> here\r\n\t\t\t\t</p>\r\n\t\t\t</Form>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default LoginPage;"]},"metadata":{},"sourceType":"module"}